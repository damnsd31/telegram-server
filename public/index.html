<script>
  const cases = [];

  function normalize(text) {
    return text.toLowerCase().replace(/[^а-яa-z0-9]/gi, '');
  }

  function renderCases(filter = '') {
    const container = document.getElementById('case-list');
    if (!container) return;
    container.innerHTML = '';
    const normalized = normalize(filter);
    const filtered = cases.filter(c =>
      normalize(c.name).includes(normalized) ||
      normalize(c.number).includes(normalized)
    );
    if (filtered.length === 0) {
      container.innerHTML = '<div style="text-align:center; opacity:0.6;">Нет дел</div>';
    } else {
      filtered.forEach(c => {
        const el = document.createElement('div');
        el.className = 'list-item';
        el.innerHTML = `<span>${c.name}</span><span>${c.number}</span>`;
        container.appendChild(el);
      });
    }
  }

  document.getElementById('search-input').addEventListener('input', (e) => {
    renderCases(e.target.value);
  });

  function openAddCaseModal() {
    document.getElementById('add-case-modal').style.display = 'flex';
  }

  function closeAddCaseModal() {
    document.getElementById('add-case-modal').style.display = 'none';
    document.getElementById('case-name').value = '';
    document.getElementById('case-number').value = '';
  }

  function addCase() {
    const name = document.getElementById('case-name').value.trim();
    const number = document.getElementById('case-number').value.trim();
    if (!name || !number) return alert('Заполните оба поля');
    cases.push({ name, number });
    renderCases(document.getElementById('search-input').value);
    closeAddCaseModal();
  }

  renderCases();
</script>
